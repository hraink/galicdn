(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[9],{28:function(n,e,t){var i=t(1);var o=window.template;e.createModal=function(n){n=$.extend({type:"normal",width:"520px",cancelText:i.get("gd-AccountSystem.component.modal.cancel"),okText:i.get("gd-AccountSystem.component.modal.confirm")},n);var e=o.compile('<div class="modal-wrapper {{wrapperClassName}}">          <div class="modal-mask"></div>          <div class="modal {{type}}" style="width: {{width}}">            {{if !hideHeader}}            <div class="modal-header">              <div class="modal-close"></div>              {{if title}}<div class="modal-title">{{title}}</div>{{/if}}            </div>            {{/if}}            <div class="modal-content">                {{#content}}            </div>            {{if !hideFooter}}            <div class="modal-footer">                <button class="button button-default cancel">{{cancelText}}</button>                <button class="button button-primary ok">{{okText}}</button>            </div>            {{/if}}          </div>        </div>');var a=$(e(n));a.delegate(".modal-close","click",n.onCancel||$.noop);a.delegate(".ok","click",n.onOk||$.noop);a.delegate(".cancel","click",n.onCancel||$.noop);$.each(n.events||{},function(n,e){var t=n.split(" ");a.delegate(t[1],t[0],e)});a.close=function(){a.undelegate();a.remove()};if(n.maskClosable){a.delegate(".modal-mask","click",a.close)}$(document.body).append(a);return a}},29:function(n,e,t){var a=t(30),i=t(31),o=t(32);n.exports={dingtalk:a,txwfy:i,alipay:o}},3:function(n,e,t){t(47);var a=t(26);var s=t(27);var d=t(2);var c=t(0);var l=t(1);var r=t(28);var i=t(29);var p=t(65),g=t(66),m=t(67),u=t(68);function f(n){var e=[{type:"commLogin",label:l.get("gd-AccountSystem.common.passwordEn"),config:{securityProtection:n.loginType==="securitLogin",supportEmail:n.loginType==="emailLogin",imgcode:n.loginType==="imgcodeLogin",passwordSmsNotImgCode:n.loginType==="passwordSmsNotImgCodeLogin",selectTenantLogin:n.feConfig.selectTenantLogin==="y"},icon:assetsLink+"assets/image/O1CN01NV1bSQ1RiSEfK8Qno_!!6000000002145-2-tps-99-99.png",checkedIcon:assetsLink+"assets/image/O1CN01Prn6Nr1KTc5uq48X8_!!6000000001165-2-tps-141-138.png",checked:["commLogin","securitLogin","emailLogin","imgcodeLogin","passwordSmsNotImgCodeLogin"].indexOf(n.loginType)>-1}];var t={alipay:{icon:assetsLink+"assets/image/O1CN014WyKIa1MZEB3QzaD3_!!6000000001448-2-tps-99-99.png",checkedIcon:assetsLink+"assets/image/O1CN01WlWxFJ1HIfmrkGbFm_!!6000000000735-2-tps-141-141.png"},dingtalk:{icon:assetsLink+"assets/image/O1CN01iqmfXz1FZxUzLV8y0_!!6000000000502-2-tps-99-96.png",checkedIcon:assetsLink+"assets/image/O1CN01UuQEDS1TN2xOQUaaY_!!6000000002369-2-tps-141-138.png"},txwfy:{icon:assetsLink+"assets/image/O1CN01KqlQCQ1yVylbW9Xkf_!!6000000006585-2-tps-99-99.png",checkedIcon:assetsLink+"assets/image/O1CN01LEDsvy1UQXaucGG2q_!!6000000002512-2-tps-141-138.png"}};if(["smsLogin","smsAutoRegLogin","smsImgLogin","smsImgAutoRegLogin"].indexOf(n.loginType)>-1){e.push({type:"smsLogin",label:l.get("gd-AccountSystem.common.VerificationCodeEn"),config:{autoRegister:["smsAutoRegLogin","smsImgAutoRegLogin"].indexOf(n.loginType)>-1,showCaptcha:["smsImgLogin","smsImgAutoRegLogin"].indexOf(n.loginType)>-1},checked:true,icon:assetsLink+"assets/image/O1CN01q2g5bZ1W2qKNqh64t_!!6000000002731-2-tps-99-96.png",checkedIcon:assetsLink+"assets/image/O1CN01Lf44S31haEzQ4UOUN_!!6000000004293-2-tps-141-138.png"})}if(n.scanCodeLogin){n.scanCodeLogin.map(function(n){e.push($.extend(n,t[n.type]))})}return e}n.exports=function(o){return new a({template:p,data:{loginTypeList:f(window.akanConfig)},events:{"click .login-type-item:not(.checked)":"changeLoginType",'click .button[data-action="login-submit"]:not(.disabled)':"submit"},changeLoginType:function(n){var e=$(n.currentTarget),t=e.data("type");e.addClass("checked").siblings(".login-type-item").removeClass("checked");this.initLoginForm(t)},initLoginForm:function(n){$(".login-container").attr("class","login-container content "+n.type);if(["alipay","dingtalk","txwfy"].indexOf(n.type)>-1){$(".login-form",this.mountNode).html(u({config:n,i18n:l.get}));this.initLoginQrcode(n)}else{var e={commLogin:g,smsLogin:m};var t=e[n.type];$(".login-form",this.mountNode).html(t({config:n.config,i18n:l.get}));this.initContent();this.listenCaptchaInput();this.listenSmsInput()}},initLoginQrcode:function(t){var a=this;i[t.type].initQrcode($.extend({containerId:"qrcode-img"},t)).done(function(n){if(n.hasBinded){$("#qrcode-img").empty().addClass("success");var e=c.getSearchParams().noCallback;if(e){c.postMessage({code:"000000",type:"AKAN_LOGIN_SUCCESS"})}a.loginSuccess()}else{d.warning("请绑定人民法院统一账号");o.push("/bind",{callback:a.loginSuccess},{bindingCode:n.bindingCode,bindtype:t.type})}}).fail(function(n){o.push("/result",{type:"error",text:n.message||"登录失败"})})},submit:function(n){var a=this,i=$('.button[data-action="login-submit"]',a.mountNode),e=i.data("api");s.exec(".login-form-container").done(function(n){i.addClass("disabled").text(l.get("gd-AccountSystem.page.login.login-process"));$.post(e||"/api/login",n).done(function(n){if(n.success){if(n.code==="000000"){d.success(n.message);c.postMessage($.extend(n,{type:"AKAN_LOGIN_SUCCESS"}));a.loginSuccess(n)}else if(["5011","5012"].indexOf(n.code)>-1){$(".login-error-tips").text(n.message).show()}else if(n.code==="TXWFY_BINDING"){var e=r.createModal({wrapperClassName:"wfy_bind",hideHeader:true,hideFooter:true,width:"320px",content:'<div class="bind-modal">\b<h1>是否绑定您的微法院账号？</h1><span class="button button-primary" data-action="tobind">去绑定</span><span data-action="login" class="tologin">直接登录</span></div>',events:{'click .button[data-action="tobind"]:not(.disabled)':function(){e.close();o.push("/bind/wfy",{callback:a.loginSuccess})},'click .tologin[data-action="login"]:not(.disabled)':function(){c.postMessage($.extend(n,{type:"AKAN_LOGIN_SUCCESS"}));a.loginSuccess(n)}}})}else{if(window.akanConfig.noWarn!=="y"){d.warning(n.message)}var t=c.getSearchParams().noCallback;if(t){c.postMessage($.extend(n,{type:"AKAN_LOGIN_SUCCESS"}))}a.loginSuccess(n)}if(n.data&&n.data.autoRegister){c.postMessage($.extend(n,{type:"LOGIN_AUTO_REGISTER"}))}}else{if(n.code==="PASSWORD_IS_EMPTY"){o.push("/resetPwdPrompt")}else{i.removeClass("disabled").text(l.get("gd-AccountSystem.page.login.login"));c.postMessage($.extend(n,{type:"LOGIN_ACCOUNT_SYSTEM"}));if(a.childWedgets.captchaInput&&n.code!=="PASSWORD_IS_ERROR"){a.childWedgets.captchaInput.reRender();a.childWedgets.smsInput.clear();if(a.childWedgets.captchaInput.mountNode.attr("data-hidden")=="false"){a.childWedgets.smsInput.hide()}}}}}).fail(function(n){i.removeClass("disabled").text(l.get("gd-AccountSystem.page.login.login"))})}).fail(function(n){})},loginSuccess:function(){var n=c.getUrlParams("back_url",window.location.href);if(n){window.location.href=n}},listenSmsInput:function(){var n=this;if(n.childWedgets.smsInput){n.childWedgets.smsInput.off("showCaptcha").on("showCaptcha",function(){n.childWedgets.captchaInput.show().getCaptcha();n.childWedgets.smsInput.hide().clear();s.clearError("smsCaptcha")});n.childWedgets.smsInput.off("validateTimeOut").on("validateTimeOut",n.handleSmsError);n.childWedgets.smsInput.off("sendError").on("sendError",n.handleSmsError)}},listenCaptchaInput:function(){var n=this;if(n.childWedgets.captchaInput){n.childWedgets.captchaInput.off("pass").on("pass",function(){n.childWedgets.smsInput.show()})}},handleSmsError:function(){this.childWedgets.captchaInput.getCaptcha();if(!this.childWedgets.captchaInput.isHide()){s.clearError("smsCaptcha");this.childWedgets.smsInput.hide().clear()}},didMount:function(){var t;$.each(this.data.loginTypeList,function(n,e){if(e.checked){t=e}});this.initLoginForm(t);s.listen(".login-form-container")}})}},30:function(n,e,t){var l=t(0);var r={},p;n.exports={msgHandler:function(n){var e=this,t=n.originalEvent.origin,a=n.originalEvent.data;if(t=="https://login.dingtalk.com"){var i=n.originalEvent.data;var o="https://oapi.dingtalk.com/connect/oauth2/sns_authorize?appid="+r.appId+"&response_type=code&scope=snsapi_login&state="+Date.now()+"&redirect_uri="+encodeURIComponent(r.redirect_uri)+"&loginTmpCode="+i;var s=$("iframe").attr("src",o);s.on("load",function(){setTimeout(function(){if(!e.authLoaded&&!s[0].contentDocument){router.push("/result",{type:"error",text:"扫码登录失败"})}},500)});$(r.containerId).after(s)}else{var d=l.safeParse(a);if(d.success&&d.data){e.authLoaded=true;var c=d.data;if(!c.success){p.reject(c)}else{p.resolve(c)}}else{p.reject(c)}}},initQrcode:function(n){var e=this;n=n;p=$.Deferred();$("#"+n.containerId).html('<span style="padding-top: 100px; display: block;">正在获取二维码...</span>');l.loadScript("https://g.alicdn.com/dingding/dinglogin/0.0.5/ddLogin.js").done(function(){DDLogin({id:n.containerId,"goto":encodeURIComponent("https://oapi.dingtalk.com/connect/oauth2/sns_authorize?appid="+n.appId+"&response_type=code&scope=snsapi_login&state="+Date.now()+"&redirect_uri="+encodeURIComponent(n.redirect_uri)),style:"border:none;background-color:#FFFFFF;",width:"300",height:"290"});$(window).off("message",e.msgHandler).on("message",e.msgHandler)});return p}}},31:function(n,e,t){var o=t(2);n.exports={pollingResult:function(a){var i=this;if(!$(".qrcode-container").hasClass("txwfy"))return;$.get(i.config.pollApi,{uuid:a}).done(function(n){if(n.code==="000000"){var e=n.data;var t={"用户未扫码":"请使用微信扫码","用户已扫码":"已扫码","5001-expired or invalid code":"二维码过期","4001-invalid paramter":"无效参数"};if(e.success){i.defer.resolve(e)}else{if(!e.reqSuccess){i.defer.reject(e);return}setTimeout(function(){i.pollingResult(a)},3e3)}}else{o.error("微信扫码失败，请刷新二维码重试！")}})},initQrcode:function(e){var t=this;t.config=$.extend({pollApi:"api/third/wechat/pc/authLogin"},e);t.defer=$.Deferred();$("#"+e.containerId).html('<span style="padding-top: 100px; display: block;">正在获取二维码...</span>');$.get("api/third/wechat/pc/getAuthQrCode").done(function(n){if(!n.success||!n.data||!n.data.pngbase64){$("#"+e.containerId).html('<span style="padding-top: 100px; display: block;">获取二维码失败</span>');return}$("#"+e.containerId).html('        <div style="margin-top: 24px">          <img id="wechat-qrcode" src="data:image/png;base64,'+n.data.pngbase64+'" style="width:230px;height:230px;padding:12px;" />        </div>');t.pollingResult(n.data.uuid)});return t.defer}}},32:function(n,e,t){var a=t(0);n.exports={pollingResult:function(a){var i=this;if(!$(".qrcode-container").hasClass("alipay"))return;$.get(i.config.pollApi,{uuid:a}).done(function(n){if(n.code==="000000"){var e=n.data;var t={0:"请使用支付宝扫码",1:"已扫码",2:"登录成功"};$("#alipay-status").text(t[e]);if(e==="2"){i.defer.resolve({hasBinded:true})}else{setTimeout(function(){i.pollingResult(a)},1500)}}})},initQrcode:function(e){var t=this;t.config=$.extend({pollApi:"api/third/alipay/mini/pollResult"},e);t.defer=$.Deferred();$("#"+e.containerId).html('<span style="padding-top: 100px; display: block;">正在获取二维码...</span>');$.post("api/third/alipay/mini/getAlipayAppletQrCode",{appId:e.appId,url:"pages/login/login",queryParams:"appId="+e.appId}).done(function(n){if(!n.success||!n.data||!n.data.url){$("#"+e.containerId).html('<span style="padding-top: 100px; display: block;">获取二维码失败</span>');return}$("#"+e.containerId).html('        <div style="margin-top: 24px">          <img id="alipay-qrcode" src="'+n.data.url+'" style="width:210px;" />        </div>');t.pollingResult(n.data.uuid)});return t.defer}}},47:function(n,e,t){"use strict";t.r(e)},65:function(n,e,t){var r=t(25);n.exports=function(n){"use strict";n=n||{};var t="",a=r.$escape,e=n.loginType,i=n.config,o=n.i18n,s=n.loginTypeList,d=r.$each,c=n.$value,l=n.$index;t+='<div class="login-container content ';t+=a(e);t+='">\n  ';if(i.logoUrl){t+='\n  <div class="login-logo-container login-image-container">\n    <img src="';t+=a(i.logoUrl);t+='" alt="" srcset="">\n  </div>\n  '}t+='\n  <div class="login-title-container">\n    ';if(i.loginTitle!==""){t+="<p>";t+=i.loginTitle;t+="</p>"}t+='\n  </div>\n  <div class="login-error-tips" style="display:none"></div>\n  <form class="login-form-container">\n    <div class="login-form">\n      \x3c!-- 具体的登录表单 --\x3e\n    </div>\n  </form>\n  <div class="login-entry-container">\n    ';if(i.hasRegister==="y"){t+='\n    <div class="register-entry">\n      <span class="none-account">';t+=a(o("gd-AccountSystem.page.login.noAccount"));t+='</span>\n      <a style="outline: none" class="register" href="#/register"\n        tabindex="-1">';t+=a(o("gd-AccountSystem.page.login.register"));t+="</a>\n    </div>\n    "}t+="\n    ";if(i.hasForgetPasswd==="y"){t+='\n    <div class="forgotpwd-entry">\n      <a style="outline: none" href="#/forgotPwd" tabindex="-1">';t+=a(o("gd-AccountSystem.page.login.forgotPwd"));t+="</a>\n    </div>\n    "}t+="\n  </div>\n  ";if(s.length>1){t+='\n  <div class="login-type-container">\n    <div class="line">';t+=a(o("gd-AccountSystem.page.login.loginMethod"));t+='</div>\n    <div class="login-type-list">\n      ';d(s,function(n,e){t+='\n      <div class="login-type-item ';t+=a(n.type);t+=" ";if(n.checked){t+="checked"}t+='" data-type="';t+=a(n);t+='"\n        title="';t+=a(o("gd-AccountSystem.common.clickToSwitch"));t+=a(n.label);t+=a(o("gd-AccountSystem.page.login.login"));t+='">\n        <img class="icon" src="';t+=a(n.icon);t+='" alt="';t+=a(n.label);t+='" width="32" height="32" />\n        <img class="icon-checked" src="';t+=a(n.checkedIcon);t+='" alt="';t+=a(n.label);t+='" width="46" height="46" />\n        <p>';t+=a(n.label);t+="</p>\n      </div>\n      "});t+="\n    </div>\n  </div>\n  "}t+="\n</div>";return t}},66:function(n,e,t){var o=t(25);n.exports=function(n){"use strict";n=n||{};var e="",t=n.config,a=o.$escape,i=n.i18n;e+="\x3c!-- 开启选择租户 --\x3e\n";if(t.selectTenantLogin){e+='\n<div class="form-field">\n  <div class="form-field-control">\n    <div class="encryptCourt-field" data-component="encryptCourtSelect" data-name="encryptCourtId"\n      data-validator="noEmptyCourt"></div>\n  </div>\n</div>\n'}e+='\n<div class="form-field">\n  \x3c!-- 用户名为邮箱/手机 --\x3e\n  ';if(t.supportEmail){e+='\n  <div class="form-field-control" data-validator="noEmpty" data-name="username">\n    <input type="text" name="username" placeholder="';e+=a(i("gd-AccountSystem.common.username"));e+='">\n  </div>\n  '}else{e+='\n  <div class="form-field-control">\n    <div class="mobile-field" data-component="phoneNumberInput" data-name="username" data-validator="phoneNumber"></div>\n  </div>\n  '}e+='\n</div>\n<div class="form-field">\n  <div class="form-field-control">\n    <div class="password-field" data-component="passwordInput" data-name="password" data-validator="password"></div>\n  </div>\n</div>\n\x3c!-- 开启图形验证码登录， --\x3e\n';if(t.imgcode){e+='\n<div class="form-field">\n  <div class="form-field-control">\n    <div class="captcha-field" data-component="captchaInput" data-name="captcha" data-validator="captcha"></div>\n  </div>\n</div>\n'}e+="\n\x3c!-- 开启等保登录 --\x3e\n";if(t.securityProtection){e+='\n<div class="form-field">\n  <div class="form-field-control">\n    <div class="captcha-field" data-component="captchaInput" data-name="captcha" data-validator="captcha"></div>\n  </div>\n</div>\n<div class="form-field">\n  <div class="form-field-control">\n    <div class="sms-field" data-component="smsInput" data-name="smsCaptcha" data-validator="smsCaptcha"\n      data-sendtemplate="LOGIN" data-hidden="true"></div>\n  </div>\n</div>\n'}e+="\n\x3c!-- 密码 + 短信验证码 + 图形验证码（当短信验证码输错多次的情况下才会出现） --\x3e\n";if(t.passwordSmsNotImgCode){e+='\n<div class="form-field captcha-form-field">\n  <div class="form-field-control">\n    <div class="captcha-field" data-component="captchaInput" data-name="captcha" data-validator="captcha"\n      data-hidden="';e+=a(t.showCaptcha?"false":"true");e+='"></div>\n  </div>\n</div>\n<div class="form-field sms-form-field">\n  <div class="form-field-control">\n    <div class="sms-field" data-component="smsInput" data-name="smsCaptcha" data-validator="smsCaptcha"\n      data-sendtemplate="LOGIN" data-hidden="';e+=a(t.showCaptcha?"true":"false");e+='"\n      data-api="/api/common/sendSmsCode"></div>\n  </div>\n</div>\n'}e+='\n<div class="login-button-container">\n  <span tabindex="0" data-mainkey="true" class="button button-primary" data-action="login-submit"\n    data-api="';if(t.passwordSmsNotImgCode){e+="/api/login/smspassword"}else{e+="/api/login"}e+='">';e+=a(i("gd-AccountSystem.page.login.login"));e+="</span>\n</div>";return e}},67:function(n,e,t){var o=t(25);n.exports=function(n){"use strict";n=n||{};var e="",t=o.$escape,a=n.config,i=n.i18n;e+='<div class="form-field">\n  <div class="form-field-control">\n    <div class="mobile-field" data-component="phoneNumberInput" data-name="username" data-validator="phoneNumber"></div>\n  </div>\n</div>\n<div class="form-field captcha-form-field">\n  <div class="form-field-control">\n    <div class="captcha-field" data-component="captchaInput" data-name="captcha" data-validator="captcha" data-hidden="';e+=t(a.showCaptcha?"false":"true");e+='"></div>\n  </div>\n</div>\n<div class="form-field sms-form-field">\n  <div class="form-field-control">\n    <div class="sms-field" data-component="smsInput" data-name="smsCaptcha" data-validator="smsCaptcha" data-sendtemplate="LOGIN" data-hidden="';e+=t(a.showCaptcha?"true":"false");e+='" data-api="/api/common/sendSmsCode"></div>\n  </div>\n</div>\n';if(a.autoRegister){e+='\n<div class="auto-register-tips">';e+=t(i("gd-AccountSystem.page.login.autoRegister"));e+="</div>\n"}e+='\n<div class="login-button-container">\n  <span tabindex="0" data-mainkey="true" class="button button-primary" data-action="login-submit" data-api="/api/sms/login">';e+=t(i("gd-AccountSystem.page.login.login"));e+="</span>\n</div>\n";return e}},68:function(n,e,t){var i=t(25);n.exports=function(n){"use strict";n=n||{};var e="",t=i.$escape,a=n.config;e+='<div class="qrcode-container ';e+=t(a.type);e+='">\n  <p class="qrcode-title">';e+=t(a.label);e+='登录</p>\n  <div class="qrcode-content">\n    <div id="qrcode-img">\n    </div>\n  </div>\n</div>\n';return e}}}]);
